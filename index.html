
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Excel Bullet Point Generator</title>
<style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f4f6f8;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 960px;
      margin: auto;
      background-color: #ffffff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      color: #2c3e50;
      text-align: center;
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-bottom: 10px;
      color: #34495e;
    }
    textarea {
      width: 100%;
      height: 200px;
      padding: 10px;
      font-family: monospace;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      resize: vertical;
      background-color: #fdfdfd;
    }
    button {
      background-color: #3498db;
      color: white;
      border: none;
      padding: 10px 20px;
      margin-right: 10px;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #2980b9;
    }
    #preview {
      margin-top: 30px;
      padding: 20px;
      background-color: #ecf0f1;
      border-radius: 6px;
      border: 1px solid #bdc3c7;
      white-space: pre-wrap;
      font-family: monospace;
      font-size: 14px;
    }
    .button-group {
      margin-top: 20px;
    }
  </style>
</head>
<body>
<div class="container">
<h2 style="font-weight: bold; font-size: 14pt; font-family: 'Calibri';color: #222222;">ðŸ“‹ Excel Bullet Point Generator</h2>
<label for="excelInput">Paste Excel Data (with headers):</label>
<textarea id="excelInput" placeholder="Paste your Excel data here..." rows="5"></textarea>
<div class="button-group">
<button onclick="generateBullets()">Generate</button>
<button onclick="downloadText()">Download .txt</button>
</div>
<div id="preview"></div>
</div>
<script>
    function generateBullets() {
      const input = document.getElementById("excelInput").value.trim();
      const lines = input.split("\n");
      if (lines.length < 2) {
        alert("Please paste data with headers and at least one row.");
        return;
      }

      const headers = lines[0].split("\t");
      const dataLines = lines.slice(1);
      const saList = [];
      const nsaList = [];
      const emsList = [];

      dataLines.forEach(line => {
        const cols = line.split("\t");
        if (cols.length < headers.length) return;

        const circle = cols[5] || "";
        let assignmentGroup = cols[9] || "";
        const technology = cols[7] || "";
        const impact = cols[8] || "";
        let description = cols[6] || "";
        const riskImpact = cols[4] || "";
        const startTime = cols[10] || "";
        const endTime = cols[11] || "";

        // Replace assignment group
        if (assignmentGroup.includes("L1_RAN_LTE_NPO")) assignmentGroup = "RF";
        else if (assignmentGroup.includes("L1_EMSOSS")) assignmentGroup = "EMSOSS";
        else if (assignmentGroup.includes("L1_RAN_WIFI")) assignmentGroup = "RF (WIFI)";


        // Remove SA, PE, NSA from description
        description = description.replace(/\b(SA|PE|NSA)\b/g, "").replace(/\s+/g, " ").trim();

        // Rearrange 'Nokia 5G' to '5G Nokia'
        description = description.replace(/\bNokia 5G\b/g, "5G Nokia");
		// time condition in 00:00 to 06:00 it will not mention 
		// if date is same mention date one time only
		// if date is different mention both dates and time
       let timeStr = "";
		const [startDate, startTimePart] = startTime.split(" ");
		const [endDate, endTimePart] = endTime.split(" ");
	
		const isEarlyMorning = (
	  	startTimePart >= "00:00" && startTimePart <= "06:00" &&
	  	endTimePart >= "00:00" && endTimePart <= "06:00"
		);

		if (!isEarlyMorning) {
		  if (startDate === endDate) {
		    timeStr = `PE timing :${startDate} ${startTimePart} Hrs to ${endTimePart} Hrs`;
		  } else {
		    timeStr = `PE timing :${startDate} ${startTimePart} Hrs to ${endDate} ${endTimePart} Hrs`;
		  }
		}

	
        // Move (NPO approval awaited) to end
        let npoNote = "";
        if (description.includes("(NPO approval awaited)")) {
          npoNote = " (NPO approval awaited)";
          description = description.replace("(NPO approval awaited)", "").trim();
        }	

 
	let bullet = "";

	if(impact==="SA"){
	  bullet = `${circle} ${assignmentGroup} (${technology}) ${impact} PE: ${description}, ${riskImpact}${timeStr ? ", " + timeStr : ""}${npoNote}`;
	}
	if(assignmentGroup==="EMSOSS"){
	  bullet = `${circle} ${assignmentGroup} (${technology}) ${impact} PE: ${description}, ${riskImpact}${timeStr ? ", " + timeStr : ""}${npoNote}`;
	}
	if(assignmentGroup==="WIFI"){
	  bullet = `${circle} ${assignmentGroup} ${impact} PE: ${description}, ${riskImpact}${timeStr ? ", " + timeStr : ""}${npoNote}`;
	}
		// removed risk and impact from NSA CRs
	else{
	bullet = `${circle} ${assignmentGroup} (${technology}) ${impact} PE: ${description} ${timeStr ? ", " + timeStr : ""}${npoNote}`;
	}


        if (impact === "SA") {
          saList.push(bullet);
        } else if (impact === "NSA" && assignmentGroup === "EMSOSS") {
          emsList.push(bullet);
        } else if (impact === "NSA") {
          nsaList.push(bullet);
        }
      });

      let output = "";
      let count = 1;
	


      if (saList.length > 0) {
        output += "RAN Domain PEs (SA): -\n\n";
        saList.forEach(item => {
          output += count++ + ". " + item + "\n";
        });
      }

      if (nsaList.length > 0) {
        output += "\nRAN Domain PEs (NSA): -\n\n";
        nsaList.forEach(item => {
          output += count++ + ". " + item + "\n";
        });
      }

      if (emsList.length > 0) {
        output += "\nEMS OSS PEs (NSA): -\n\n";
        emsList.forEach(item => {
          output += count++ + ". " + item + "\n";
        });
      }

      document.getElementById("preview").textContent = output.trim();
    }

    function downloadText() {
      const text = document.getElementById("preview").textContent;
      if (!text) {
        alert("No output to download. Please generate first.");
        return;
      }

      const blob = new Blob([text], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "bullet_points.txt";
      link.click();
    }
  </script>
</body>
</html>
